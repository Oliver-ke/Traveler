!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){},function(t,e,n){"use strict";n.r(e);const r=document.querySelector("input[name=location]"),a=document.querySelector("input[name=date]"),o=document.querySelector(".spinner"),s=document.querySelector("span.error"),i=document.querySelector("section.landing"),c=document.querySelector("section.trip"),u=document.querySelector("section.saved-trips"),l=document.querySelector(".location-img"),d=document.querySelector(".country-info"),p=document.querySelector(".weather-info"),m=document.querySelector(".trip-items"),S=document.querySelector("form"),E=document.querySelector("input[type=submit]"),I=document.querySelector("button.save-trip"),f=document.querySelector("button.new-trip"),_=document.querySelector(".view-trip"),y=document.querySelector(".new-trip-onsaved"),R=async(t,e)=>{try{const n=await e(t);return{error:null,data:await n.json()}}catch(e){return console.log(`${e} ${t}`),{error:e,data:null}}};var v=(t,e,n,r=null)=>{const a=n[t];switch(t){case"GEONAMES":{const t=r.GEO_USER_NAME,n=encodeURIComponent(e);return`${a}?${`maxRows=20&operator=OR&q=${n}&name=${n}&username=${t}`}`}case"WEATHERBIT":{const t=r.WEATHERBIT_API_KEY,{lat:n,lon:o,days:s}=e;return`${a}?${`key=${t}&lat=${n}&lon=${o}&days=${s}`}`}case"PIXABAY":return`${"https://cors-anywhere.herokuapp.com/"}${a}?${`key=${r.PIXABAY_API_KEY}&q=${encodeURIComponent(e)}&per_page=4`}`;case"RESTCOUNTRY":return`${a}/${encodeURIComponent(e)}`;default:return}};const T={GEO_USER_NAME:"oliverke",WEATHERBIT_API_KEY:"833f5515002f470bb298e49362d3a40a",PIXABAY_API_KEY:"9791837-24687b3b0fb9fe7f0289366cc"},b={GEONAMES:"http://api.geonames.org/searchJSON",WEATHERBIT:"https://api.weatherbit.io/v2.0/forecast/daily",PIXABAY:"https://pixabay.com/api/",RESTCOUNTRY:"https://restcountries.eu/rest/v2/name"};var O=(t,e=null,n=null)=>{switch(t){case"START_SPINNER":return void e.classList.add("show-spinner");case"STOP_SPINNER":return void e.classList.remove("show-spinner");case"SHOW_ERROR":return e.classList.add("show-error"),void(e.textContent=n);case"HIDE_LANDING":return void e.classList.remove("active");case"SHOW_LANDING":case"SHOW_SAVED_TRIP":return void e.classList.add("active");case"HIDE_SAVED_TRIP":return void e.classList.remove("active");case"SHOW_TRIP":return void e.classList.add("active");case"HIDE_TRIP":return void e.classList.remove("active");case"BUILD_TRIP_IMG":{const t=document.createElement("div");return n.forEach(e=>{const n=document.createElement("img");n.setAttribute("src",e),t.appendChild(n)}),void e.appendChild(t)}case"BUILD_COUNTRY_INFO":{const{name:t,capital:r,region:a,subregion:o,currencies:s,flag:i,timezones:c}=n;return void(e.innerHTML=`\n\t\t\t<div class="text-content">\n\t\t\t\t<p>\n\t\t\t\t\t<span>Country:</span> ${t} <br> \n\t\t\t\t\t<span>Capital:</span> ${r}  <br>\n\t\t\t\t\t<span>Region:</span> ${a} <br> \n\t\t\t\t\t<span>Subregion:</span> ${o} <br>\n\t\t\t\t\t<span>Currency:</span> ${s[0].name} | ${s[0].symbol} <br>\n\t\t\t\t\t<span>Timezone:</span> ${c[0]}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<img src=${i}></img> \n\t\t\t`)}case"BUILD_WEATHER_FIELDS":return void n.forEach(t=>{const{datetime:n,weather:r,temp:a,snow:o,wind_spd:s,wind_cdir:i}=t,{icon:c,description:u}=r,l=document.createElement("div");l.setAttribute("class","field"),l.innerHTML=`\n\t\t\t\t\t<div class="description">\n\t\t\t\t\t\t<img style="width: 50px; height: 50px;" src="./icons/${c}.png" alt="weather-icon">\n\t\t\t\t\t\t<span>${u}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="content">\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tTemperature: <span>${a}°C</span> <span class="bar">|</span>\n\t\t\t\t\t\t\tSnow: <span>${o}</span> <span class="bar">|</span>\n\t\t\t\t\t\t\tWind Speed: <span>${s}</span> <span class="bar">|</span>\n\t\t\t\t\t\t\tWind Direction: <span>${i}</span> <span class="bar">|</span>\n\t\t\t\t\t\t\tDate: <span>${n}</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t`,e.appendChild(l)});case"BUILD_SAVED_TRIP":return e.innerHTML="",void n.forEach(t=>{const{input:n,countryInfo:{name:r},weather:a}=t,{datetime:o,weather:s,temp:i}=a.pop(),{description:c}=s,u=document.createElement("div"),l=document.createElement("button");l.setAttribute("class","btn delete-trip danger"),l.setAttribute("data",n.location),l.addEventListener("click",N),l.innerHTML='\n\t\t\t\t\t<i class="fas fa-times"></i>\n\t\t\t\t',u.setAttribute("class","trip-item"),u.innerHTML=`\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<span>Location:</span> ${n.location}<br>\n\t\t\t\t\t\t<span>Date:</span> ${o} <br>\n\t\t\t\t\t\t<span>Country:</span> ${r}<br>\n\t\t\t\t\t\t<span>Weather:</span> ${c} <br>\n\t\t\t\t\t\t<span>Temperature:</span> ${i}°C <br>\n\t\t\t\t\t</p>\n\t\t\t\t`,u.appendChild(l),e.appendChild(u)});case"SWITCH_SECTION_TO":return window.location.reload(!1);case"CLEAR_ERROR":return e.classList.remove("show-error");default:return}};const g={coordinate:{},weather:[],countryInfo:{},pictures:[],input:{}},h=async t=>{t.preventDefault();const e=r.value,n=a.value;if(!e||!n)return O("SHOW_ERROR",s,"Provide a location and date");const{error:u,days:m}=(t=>{const e=new Date,n=new Date(t);if(n<e)return{error:"Date is behind",days:null};const r=n.getTime()-e.getTime(),a=Math.round(r/864e5);return a>16?{error:"Can only get forcast for 16 days max",days:null}:{error:null,days:a}})(n);if(u)return O("SHOW_ERROR",s,u);g.input={location:e,date:n,days:m},O("CLEAR_ERROR",s),O("START_SPINNER",o);const S=v("GEONAMES",e,b,T),{error:E,data:I}=await R(S,fetch);if(E||!I.geonames[0])return O("STOP_SPINNER",o),O("SHOW_ERROR",s,"Could not find Location");const{lng:f,lat:_,countryName:y}=I.geonames[0];g.coordinate={lon:f,lat:_};const h=v("WEATHERBIT",{lon:f,lat:_,days:m},b,T),{data:A}=await R(h,fetch);g.weather=A.data;const N=v("RESTCOUNTRY",y,b),{data:L,error:$}=await R(N,fetch);if($)return O("STOP_SPINNER",o),O("SHOW_ERROR",s,"Could not get location country");g.countryInfo=L[0];const w=v("PIXABAY",y,b,T),{data:P}=await R(w,fetch);var D,H;g.pictures=(D=P.hits,H="webformatURL",D.map(t=>t[H])),O("BUILD_TRIP_IMG",l,g.pictures),O("BUILD_COUNTRY_INFO",d,g.countryInfo),O("BUILD_WEATHER_FIELDS",p,g.weather),O("STOP_SPINNER",o),O("HIDE_LANDING",i),O("SHOW_TRIP",c)},A=()=>O("SWITCH_SECTION_TO"),N=t=>{const e=t.target.getAttribute("data"),n=JSON.parse(localStorage.getItem("trips")).filter(t=>t.input.location!==e);localStorage.setItem("trips",JSON.stringify(n)),O("BUILD_SAVED_TRIP",m,n)};n(0);E.addEventListener("submit",h),S.addEventListener("submit",h),I.addEventListener("click",t=>{const e=JSON.parse(localStorage.getItem("trips"));if(null===e||e.length<1){const t=JSON.stringify([g]);return localStorage.setItem("trips",t),alert("Trip saved Successfully")}if(e[e.length-1].input.location==g.input.location)return alert("Trip already saved");const n=JSON.stringify([...e,g]);return localStorage.setItem("trips",n),alert("Trip saved Successfully")}),f.addEventListener("click",A),_.addEventListener("click",()=>{const t=JSON.parse(localStorage.getItem("trips"));if(null===t)return alert("You have no saved trips yet, save a trip");O("BUILD_SAVED_TRIP",m,t),O("HIDE_TRIP",c),O("HIDE_LANDING",i),O("SHOW_SAVED_TRIP",u)}),y.addEventListener("click",A)}]);